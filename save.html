<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>êµ¬ê¸€ ì‹œíŠ¸ ì €ì¥ í…ŒìŠ¤íŠ¸ (íƒêµ¬ ë¦¬ê·¸)</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
    }

    .input-group {
      margin-bottom: 20px;
      background: #f0f9ff;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #bfdbfe;
    }

    .input-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
      color: #1e3a8a;
    }

    .input-group input {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .btn-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      color: white;
      transition: opacity 0.2s;
    }

    button:hover {
      opacity: 0.9;
    }

    .btn-attend {
      background: #3b82f6;
    }

    /* Blue */
    .btn-high-win {
      background: #eab308;
      color: black;
    }

    /* Gold */
    .btn-low-win {
      background: #22c55e;
    }

    /* Green */

    pre {
      background: #1e293b;
      color: #cbd5e1;
      padding: 15px;
      border-radius: 8px;
      overflow: auto;
      min-height: 150px;
      font-size: 13px;
    }
  </style>
</head>

<body>
  <h2>ğŸ“Š êµ¬ê¸€ ì‹œíŠ¸ ì €ì¥ í…ŒìŠ¤íŠ¸</h2>

  <div class="input-group">
    <label for="gasUrl">Google Apps Script (Web App) URL:</label>
    <input type="text" id="gasUrl"
      value="https://script.google.com/macros/s/AKfycbybkNRimOGBcCYH7HAbiT6lhlqtT9SzVZ0QjDxkD6By1ePgtv5XS8-eGSIIRocNpdJn/exec" />
  </div>


  <p>ì•„ë˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ê°€ìƒì˜ ê²°ê³¼ê°€ ì „ì†¡ë©ë‹ˆë‹¤.</p>

  <div class="btn-row">
    <button id="btnAttend" class="btn-attend">1. ì°¸ê°€ ì ìˆ˜ (+2ì )</button>
    <button id="btnHighWin" class="btn-high-win">2. ìƒìœ„ ìš°ìŠ¹ (+5ì )</button>
    <button id="btnLowWin" class="btn-low-win">3. í•˜ìœ„ ìš°ìŠ¹ (+4ì )</button>
  </div>

  <div>
    <strong>ğŸ“¡ ì „ì†¡ ë¡œê·¸</strong>
    <pre id="log">ëŒ€ê¸° ì¤‘...</pre>
  </div>

  <script>
    // âš™ï¸ í…ŒìŠ¤íŠ¸ìš© ê°€ìƒ ë°ì´í„°
    const PLAYER_NAME = "ë°•ë§Œì˜ (í…ŒìŠ¤íŠ¸)";

    function log(msg, data = null) {
      const el = document.getElementById("log");
      const time = new Date().toLocaleTimeString();
      let text = `[${time}] ${msg}`;
      if (data) text += "\n" + JSON.stringify(data, null, 2);
      el.innerText = text + "\n\n" + el.innerText;
    }

    async function sendData(type, points, detail) {
      const url = document.getElementById("gasUrl").value.trim();
      if (!url) {
        alert("ë¨¼ì € Apps Script URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        return;
      }

      // 1. ë³´ë‚¼ ë°ì´í„° êµ¬ì„± (Implementation Plan ìŠ¤í‚¤ë§ˆ ì¤€ìˆ˜)
      const payload = {
        date: new Date().toISOString().split('T')[0], // "2024-01-01"
        results: [
          {
            name: PLAYER_NAME,
            type: type,   // "ì°¸ê°€", "ìƒìœ„ ìš°ìŠ¹" ë“±
            points: points, // ìˆ«ì
            detail: detail // ìƒì„¸ ë‚´ìš©
          }
        ]
      };

      log("ğŸ“¤ ë°ì´í„° ì „ì†¡ ì¤‘...", payload);

      try {
        // 2. Fetch ì „ì†¡ (Google Apps Script Web Appì€ no-cors ì¶”ì²œ)
        // 'no-cors' ëª¨ë“œëŠ” ì‘ë‹µ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ì—†ì§€ë§Œ(Opaque), ë¸Œë¼ìš°ì € ì—ëŸ¬ ì—†ì´ ì „ì†¡ ì„±ê³µ ì—¬ë¶€ëŠ” ì•Œ ìˆ˜ ìˆìŒ.
        // í•˜ì§€ë§Œ GASê°€ text/plain + CORS í—¤ë”ë¥¼ ì˜ ì£¼ë©´ normal modeë„ ê°€ëŠ¥í•¨.
        // ì—¬ê¸°ì„œëŠ” ì•ˆì „í•˜ê²Œ text/plainìœ¼ë¡œ ë³´ëƒ„.

        const response = await fetch(url, {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "text/plain"
          },
          body: JSON.stringify(payload)
        });

        // no-corsëŠ” response.ok ì ‘ê·¼ ë¶ˆê°€, status 0
        log("âœ… ì „ì†¡ ì™„ë£Œ! (êµ¬ê¸€ ì‹œíŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”)");

      } catch (err) {
        log("âŒ ì „ì†¡ ì‹¤íŒ¨: " + err.message);
      }
    }

    // âœ¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById("btnAttend").onclick = () => {
      sendData("ì°¸ê°€", 2, "ì •ê¸°ëª¨ì„ ì°¸ê°€");
    };

    document.getElementById("btnHighWin").onclick = () => {
      sendData("ìƒìœ„ ìš°ìŠ¹", 5, "ìƒìœ„ë¦¬ê·¸ ê²°ìŠ¹ ìŠ¹ë¦¬");
    };

    document.getElementById("btnLowWin").onclick = () => {
      sendData("í•˜ìœ„ ìš°ìŠ¹", 4, "í•˜ìœ„ë¦¬ê·¸ ê²°ìŠ¹ ìŠ¹ë¦¬");
    };
  </script>
</body>

</html>